<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>

	<!-- Extranet Environment Configurator -->
	<bean id="extranet.environment.configurator" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    	<property name="location">
			<value>/WEB-INF/classes/alfresco/extranet.properties</value>
		</property>
	</bean>

	

	<!-- Extranet Application Properties -->
	<bean id="application.properties" class="org.alfresco.extranet.ApplicationProperties">
		<property name="hostPort" value="${application.hostPort}" />
		<property name="webapp" value="${application.webapp}" />
	</bean>

	<!--               -->
	<!-- Core Services -->
	<!--               -->
	<bean id="extranet.service.invitation" class="org.alfresco.extranet.InvitationService">
		<property name="webHelpdeskService" ref="extranet.service.webhelpdesk" />
		<property name="ldapService" ref="extranet.service.ldap" />
		<property name="databaseService" ref="extranet.service.database" />
		<property name="mailService" ref="extranet.service.mail" />
		<property name="alfrescoHostPort" value="${alfresco.hostPort}" />
	</bean>
	<bean id="extranet.service.user" class="org.alfresco.extranet.UserService">
		<property name="webHelpdeskService" ref="extranet.service.webhelpdesk" />
		<property name="ldapService" ref="extranet.service.ldap" />
		<property name="databaseService" ref="extranet.service.database" />
		<property name="mailService" ref="extranet.service.mail" />
	</bean>
	<bean id="extranet.service.group" class="org.alfresco.extranet.GroupService">
		<property name="webHelpdeskService" ref="extranet.service.webhelpdesk" />
		<property name="ldapService" ref="extranet.service.ldap" />
		<property name="databaseService" ref="extranet.service.database" />
		<property name="mailService" ref="extranet.service.mail" />
	</bean>
	<bean id="extranet.service.company" class="org.alfresco.extranet.CompanyService">
		<property name="webHelpdeskService" ref="extranet.service.webhelpdesk" />
		<property name="ldapService" ref="extranet.service.ldap" />
		<property name="databaseService" ref="extranet.service.database" />
		<property name="mailService" ref="extranet.service.mail" />
	</bean>



	<!--                                   -->
	<!-- Application Service: Web Helpdesk -->
	<!--                                   -->
	<bean id="extranet.service.webhelpdesk" class="org.alfresco.extranet.webhelpdesk.WebHelpdeskService">
		<property name="jdbcTemplate" ref="extranet.service.webhelpdesk.jdbc.template" />
	
	</bean>
	<bean id="extranet.service.webhelpdesk.jdbc.template" class="org.springframework.jdbc.core.JdbcTemplate">
		<constructor-arg>
			<ref bean="extranet.service.webhelpdesk.jdbc.datasource" />
		</constructor-arg>
	</bean>
	<bean id="extranet.service.webhelpdesk.jdbc.datasource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
		<property name="driverClassName" value="${webhelpdesk.db.driverClassName}" />
		<property name="url" value="${webhelpdesk.db.url}" />
		<property name="username" value="${webhelpdesk.db.username}" />
		<property name="password" value="${webhelpdesk.db.password}" />
	</bean>	
	
	
	
	<!--                               -->
	<!-- Application Service: Database -->
	<!--                               -->	
	<bean id="extranet.service.database" class="org.alfresco.extranet.database.DatabaseService">
		<property name="userBean" ref="extranet.service.database.userbean" />
		<property name="groupBean" ref="extranet.service.database.groupbean" />
		<property name="companyBean" ref="extranet.service.database.companybean" />
		<property name="invitedUserBean" ref="extranet.service.database.inviteduserbean" />
	</bean>
	<bean id="extranet.service.database.userbean" class="org.alfresco.extranet.database.DatabaseUserBean" singleton="false">
		<property name="jdbcTemplate">
			<ref bean="extranet.service.database.jdbc.template" />
		</property>
	</bean>
	<bean id="extranet.service.database.groupbean" class="org.alfresco.extranet.database.DatabaseGroupBean" singleton="false">
		<property name="jdbcTemplate">
			<ref bean="extranet.service.database.jdbc.template" />
		</property>
	</bean>
	<bean id="extranet.service.database.companybean" class="org.alfresco.extranet.database.DatabaseCompanyBean" singleton="false">
		<property name="jdbcTemplate">
			<ref bean="extranet.service.database.jdbc.template" />
		</property>
	</bean>
	<bean id="extranet.service.database.inviteduserbean" class="org.alfresco.extranet.database.DatabaseInvitedUserBean" singleton="false">
		<property name="jdbcTemplate">
			<ref bean="extranet.service.database.jdbc.template" />
		</property>
	</bean>
	<bean id="extranet.service.database.jdbc.template" class="org.springframework.jdbc.core.JdbcTemplate">
		<constructor-arg>
			<ref bean="extranet.service.database.jdbc.datasource" />
		</constructor-arg>
	</bean>
	<bean id="extranet.service.database.jdbc.datasource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
		<property name="driverClassName" value="${application.db.driverClassName}" />
		<property name="url" value="${application.db.url}" />
		<property name="username" value="${application.db.username}" />
		<property name="password" value="${application.db.password}" />
	</bean>	

	
	
	<!--                           -->
	<!-- Application Service: LDAP -->
	<!--                           -->		
	<bean id="extranet.service.ldap" class="org.alfresco.extranet.ldap.LDAPService">
		<property name="userBean" ref="extranet.service.ldap.userbean" />
		<property name="groupBean" ref="extranet.service.ldap.groupbean" />
		<property name="companyBean" ref="extranet.service.ldap.companybean" />	
	</bean>
    <bean id="extranet.service.ldap.userbean"
        class="org.alfresco.extranet.ldap.LDAPUserBean">
        <property name="ldapTemplate" ref="extranet.service.ldap.template" />
    </bean>
    <bean id="extranet.service.ldap.groupbean"
        class="org.alfresco.extranet.ldap.LDAPGroupBean">
        <property name="ldapTemplate" ref="extranet.service.ldap.template" />
    </bean>
    <bean id="extranet.service.ldap.companybean"
        class="org.alfresco.extranet.ldap.LDAPCompanyBean">
        <property name="ldapTemplate" ref="extranet.service.ldap.template" />
    </bean>
	<bean id="extranet.service.ldap.contextsource" class="org.springframework.ldap.core.support.LdapContextSource">
		<property name="url" value="${application.ldap.url}" />
		<property name="base" value="${application.ldap.base}" />
		<property name="userName" value="${application.ldap.userName}" />
		<property name="password" value="${application.ldap.password}" />
    </bean>
    <bean id="extranet.service.ldap.template" class="org.springframework.ldap.core.LdapTemplate">
        <constructor-arg ref="extranet.service.ldap.contextsource" />
    </bean>	
    

    
	<!--                            -->
	<!-- Application Service: Email -->
	<!--                            -->		
	<bean id="extranet.service.mail" class="org.alfresco.extranet.mail.MailService">
		<property name="mailSender" ref="extranet.service.mail.sender"/>
		<property name="adminEmailAddress" value="${application.email.address}"/>
		<property name="inviteUserEmailTemplateUrl" value="${application.email.inviteUserEmailTemplateUrl}"/>
	</bean>    
	<bean id="extranet.service.mail.sender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
		<property name="host" value="${application.email.host}"/>
		<property name="username" value="${application.email.username}"/>
		<property name="password" value="${application.email.password}"/>
		<property name="javaMailProperties">
			<props>
				<prop key="mail.smtp.auth">true</prop>
		       </props>
		</property>		
	</bean>
    
    
	<!--                            -->
	<!-- Application Service: JIRA -->
	<!--                            -->		
	<bean id="extranet.service.jira" class="org.alfresco.extranet.jira.JIRAService">
		<property name="server" value="${jira.server}"/>
		<property name="username" value="${jira.username}"/>
		<property name="password" value="${jira.password}"/>
	</bean>    



   <!--  Extranet Declarative Web Script -->
   <bean id="webscript.extranet" parent="webscript" class="org.alfresco.web.scripts.DeclarativeExtranetWebScript" singleton="false" />
    
    
    
    <!--  A few overrides -->
   <bean id="webframework.webscripts.templateprocessor" class="org.alfresco.web.scripts.PresentationTemplateProcessor">
      <property name="searchPath" ref="webframework.searchpath" />
      <property name="updateDelay"><value>0</value></property>
      <property name="defaultEncoding"><value>UTF-8</value></property>
   </bean>
   
   <bean id="webframework.templateprocessor" class="org.alfresco.web.scripts.PresentationTemplateProcessor">
      <property name="searchPath" ref="webframework.templates.searchpath" />
      <property name="defaultEncoding"><value>UTF-8</value></property>
      <property name="updateDelay"><value>0</value></property>
   </bean>
   
   
   
   
   
   
</beans>