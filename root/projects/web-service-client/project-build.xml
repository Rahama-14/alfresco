<project name="web-service-client" default="build">

    <path id="path.common" path="${basedir}/../../common"/>
    <property name="dir.common" refid="path.common" />
    <import file="${dir.common}/common.xml" />
	
	<path id="path.wsdl" path="${basedir}/../remote-api/source/wsdl"/>
	<property name="dir.wsdl" refid="path.wsdl"/>
	
	<property name="package.dir" value="/org/alfresco/webservice"/>
	<property name="package.path" value="org.alfresco.webservice"/>

	<!-- init target -->
    <target name="init" depends="common-init.init">
        <taskdef name="wsdl2java" classname="org.apache.axis.tools.ant.wsdl.Wsdl2javaAntTask">
            <classpath refid="classpath.compile" />
        </taskdef>
       <property name="files.delete.include" value="*Service.java,*Locator.java,*Binding*.java,undeploy.wsdd"/>
    </target> 

    <!-- we need to override the compile-java target so that we can include the generated source -->
    <target name="compile-java" depends="init" description="Compiles the Java source code">
        <mkdir dir="${dir.classes}" />
        <javac destdir="${dir.classes}" fork="true" deprecation="on" debug="on" target="1.5" source="1.5">
            <src path="${dir.src.java}" />
            <src path="${dir.src.java.generated}" />
            <classpath refid="classpath.compile" />
        </javac>

        <copy todir="${dir.classes}">
            <fileset dir="${dir.src.java}">
                <patternset>
                    <exclude name="**/*.java" />
                </patternset>
            </fileset>
        </copy>
    </target>

    <target name="package-jar" depends="common.package-jar" description="Packages the JAR file">
        <jar jarfile="${dir.dist}/${file.name.jar}" update="true">
        </jar>
    </target>

    <target name="package-war">
        <echo>
         This project can not produce a WAR file, the Remote API functionality is currently
         packaged within the Web Client WAR file.
      </echo>
    </target>

    <target name="clean-all-services" depends="init">
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}" />
        </delete>
    </target>
        
    <target name="gen-all-service-clients" depends="gen-auth-service-client, gen-repo-service-client, gen-content-service-client, gen-authoring-service-client, gen-classification-service-client, gen-action-service-client, gen-access-control-service-client, gen-administration-service-client" />

    <target name="gen-auth-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/authentication" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/authentication" />
        </delete>
        <wsdl2java url="${dir.wsdl}/authentication-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/authentication/1.0" package="${package.path}.authentication" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-repo-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/repository" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/repository" />
        </delete>
        <wsdl2java url="${dir.wsdl}/repository-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/repository/1.0" package="${package.path}.repository" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
            <mapping namespace="http://www.alfresco.org/ws/cml/1.0" package="${package.path}.types" />
            <mapping namespace="http://www.alfresco.org/ws/headers/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-content-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/content" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/content" />
        </delete>
        <wsdl2java url="${dir.wsdl}/content-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/content/1.0" package="${package.path}.content" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-classification-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/classification" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/classification" />
        </delete>
        <wsdl2java url="${dir.wsdl}/classification-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/classification/1.0" package="${package.path}.classification" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-authoring-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/authoring" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/authoring" />
        </delete>
        <wsdl2java url="${dir.wsdl}/authoring-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/authoring/1.0" package="${package.path}.authoring" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-action-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/action" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/action" />
        </delete>
        <wsdl2java url="${dir.wsdl}/action-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/action/1.0" package="${package.path}.action" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-access-control-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/accesscontrol" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/accesscontrol" />
        </delete>
        <wsdl2java url="${dir.wsdl}/access-control-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/accesscontrol/1.0" package="${package.path}.accesscontrol" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

    <target name="gen-administration-service-client" depends="init">
        <mkdir dir="${dir.src.java.generated}${package.dir}/administration" />
        <delete>
            <fileset dir="${dir.src.java.generated}${package.dir}/administration" />
        </delete>
        <wsdl2java url="${dir.wsdl}/administration-service.wsdl" output="${dir.src.java.generated}" testcase="no" all="true">
            <mapping namespace="http://www.alfresco.org/ws/service/administration/1.0" package="${package.path}.administration" />
            <mapping namespace="http://www.alfresco.org/ws/model/content/1.0" package="${package.path}.types" />
        </wsdl2java>
    </target>

</project>
