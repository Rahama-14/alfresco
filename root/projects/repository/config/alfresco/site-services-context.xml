<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>

	<bean id="siteService_dictionaryBootstrap" parent="dictionaryModelBootstrap" depends-on="dictionaryBootstrap">
        <property name="models">
            <list>
                <value>alfresco/model/siteModel.xml</value>
            </list>
        </property>
    </bean>
       
    <!-- Bootstrap the permission model -->
    <bean id="siteService_permissionBootstrap" parent="permissionModelBootstrap">
    	<property name="model" value="alfresco/model/sitePermissionDefinitions.xml"/>
    </bean>
    
    <!-- Site service bean -->
    <bean id="SiteService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.repo.site.SiteService</value>
        </property>
        <property name="target">
            <ref bean="siteService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="SiteService_transaction"/>
                <idref bean="AuditMethodInterceptor"/>
                <idref bean="exceptionTranslator"/>
                <idref local="SiteService_security"/>
            </list>
        </property>
    </bean>

    <!-- Site service transaction bean -->
    <bean id="SiteService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>
    
    <!-- Site service security bean -->
    <bean id="SiteService_security" class="org.alfresco.repo.security.permissions.impl.AlwaysProceedMethodInterceptor" />
    
    
    <bean id="siteService" class="org.alfresco.repo.site.SiteServiceImpl">
       <property name="nodeService" ref="NodeService"/>
       <property name="fileFolderService" ref="FileFolderService"/>
       <property name="searchService" ref="SearchService"/>
       <property name="permissionService" ref="PermissionService" />
       <property name="authenticationComponent" ref="authenticationComponent"/>      
       <property name="personService" ref="PersonService"/>
       <property name="activityService" ref="activityService"/>
       <property name="taggingService" ref="TaggingService"/>
       <property name="authorityService" ref="AuthorityService"/>
    </bean>
    
    <bean id="siteServiceScript" parent="baseJavaScriptExtension" class="org.alfresco.repo.site.script.ScriptSiteService">
        <property name="extensionName">
            <value>siteService</value>
        </property>
        <property name="serviceRegistry" ref="ServiceRegistry"/>
        <property name="siteService" ref="siteService"/>
    </bean>
    
    
</beans>
