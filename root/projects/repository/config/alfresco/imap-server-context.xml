<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>

   <bean id="imapResourceBundles" class="org.alfresco.i18n.ResourceBundleBootstrapComponent">
        <property name="resourceBundles">
            <list>
                <value>alfresco.messages.imap-service</value>
            </list>
        </property>
   </bean>
   
   <bean id="imapServerConfigurationProperties" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
      <property name="ignoreUnresolvablePlaceholders">
         <value>true</value>
      </property>
      <property name="locations">
         <list>
            <value>classpath:alfresco/imap-server.properties</value>
         </list>
      </property>
   </bean>

   <bean id="imapHelper" class="org.alfresco.repo.imap.ImapHelper">
       <property name="nodeService" ref="NodeService" />
       <property name="fileFolderService" ref="FileFolderService" />
       <property name="searchService" ref="SearchService" />
       <property name="namespaceService" ref="NamespaceService" />
       <property name="templateService" ref="TemplateService" />
       <property name="permissionService" ref="PermissionService" />
       <property name="configService" ref="webClientConfigService" />
       <property name="dictionaryService" ref="DictionaryService" />
       <property name="preferenceService" ref="PreferenceService" />
       <property name="siteService" ref="SiteService" />
       <property name="patchService" ref="patchComponent" />
       
       
       <property name="serviceRegistry" ref="ServiceRegistry" />
       
       <property name="defaultFromAddress">
            <value>${mail.from.default}</value>
        </property>

       <property name="webApplicationContextUrl">
            <value>${web.application.context.url}</value>
        </property>
       
       <property name="imapRoot">
             <value>${spaces.store}/${spaces.company_home.childname}/${spaces.imap_home.childname}</value> 
        </property>
        
        <property name="repositoryTemplatePath">
           <value>${spaces.store}/${spaces.company_home.childname}/${spaces.dictionary.childname}/${spaces.imapConfig.childname}/${spaces.imap_templates.childname}</value>
        </property>
    </bean>

    <bean id="imapServer" class="org.alfresco.repo.imap.AlfrescoImapServer">
        <property name="port">
              <value>${imap.server.port}</value>
        </property>
        <property name="imapServerEnabled">
             <value>${imap.server.enabled}</value>
        </property>
        <property name="imapHostManager">
             <ref local="imapHostManager"/>
        </property>
        <property name="imapUserManager">
             <ref local="imapUserManager"/>
        </property>
        <property name="imapHelper">
             <ref local="imapHelper"/>
        </property>
    </bean>
   
    <bean id="imapHostManager" class="org.alfresco.repo.imap.AlfrescoImapHostManager" >
       <property name="serviceRegistry" ref="ServiceRegistry" />
       <property name="nodeService" ref="NodeService" />
       <property name="fileFolderService" ref="FileFolderService" />
       <property name="imapHelper" ref="imapHelper" />
    </bean>

    <bean id="imapUserManager" class="org.alfresco.repo.imap.AlfrescoImapUserManager">
       <property name="imapHostManager">
          <ref local="imapHostManager" />
       </property>
       <property name="authenticationService" ref="AuthenticationService" />
       <property name="personService" ref="PersonService" />
       <property name="nodeService" ref="NodeService" />
    </bean>
</beans>
