<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="ActivityFeedControl">

   <typeAlias alias="FeedControl" type="org.alfresco.repo.activities.feed.control.FeedControlDAO"/>

   <resultMap id="FeedControlResult" class="FeedControl">
      <result property="id" column="id"/>
      <result property="feedUserId" column="feed_user_id"/>
      <result property="siteNetwork" column="site_network"/>
      <result property="appTool" column="app_tool"/>
      <result property="lastModified" column="last_modified"/>
   </resultMap>
  
   <select id="select.activity.feedcontrols.for.user" parameterClass="FeedControl" resultClass="FeedControl">
      <![CDATA[
      select id as id, feed_user_id as feedUserId, site_network as siteNetwork, app_tool as appTool
      from alf_activity_feed_control
      where feed_user_id = #feedUserId#
      ]]>
   </select>
   
   <select id="select.activity.feedcontrol" parameterClass="FeedControl" resultClass="long">
      <![CDATA[
      select id as id
      from alf_activity_feed_control
      where feed_user_id = #feedUserId#
      and site_network = #siteNetwork#
      and app_tool = #appTool#
      ]]>
   </select>

   <insert id="insert.activity.feedcontrol" parameterClass="FeedControl">
      insert into alf_activity_feed_control (id, feed_user_id, site_network, app_tool, last_modified)
      values (DEFAULT, #feedUserId#, #siteNetwork#, #appTool#, #lastModified#)
      
      <!-- optionally return auto-generated primary key - only required for debug (can be commented out) -->
      <selectKey resultClass="long" keyProperty="id" type="post">
         values IDENTITY_VAL_LOCAL()
      </selectKey>
   </insert>
  
   <delete id="delete.activity.feedcontrol" parameterClass="FeedControl">
      <![CDATA[
      delete from alf_activity_feed_control
      where feed_user_id = #feedUserId#
      and site_network = #siteNetwork#
      and app_tool = #appTool#
      ]]>
   </delete>

</sqlMap>